<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nora Elliott">
<meta name="dcterms.date" content="2025-02-10">
<meta name="description" content="AI’s attempts at humor are put to the test as it generates jokes, revealing both its strengths in observational comedy and its limitations compared to the creativity and timing of human comedians.">

<title>AI’s Take on “What Makes a Good Joke?”: Can it Be Funny? – My Explorations with LLMs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-d4d76bf8491c20bad77d141916dc28e1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-5e113afdac1e418f162bce274ee92ddb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">My Explorations with LLMs</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">AI’s Take on “What Makes a Good Joke?”: Can it Be Funny?</h1>
                  <div>
        <div class="description">
          AI’s attempts at humor are put to the test as it generates jokes, revealing both its strengths in observational comedy and its limitations compared to the creativity and timing of human comedians.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">LLMs</div>
                <div class="quarto-category">prompting</div>
                <div class="quarto-category">logic</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Nora Elliott </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 10, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="what-makes-a-joke-funny" class="level3">
<h3 class="anchored" data-anchor-id="what-makes-a-joke-funny">What makes a joke funny?</h3>
<p>We all know the formula: set-up, punchline, timing. But does AI understand this formula? I’ve spent plenty of time laughing at Memes and Tiktoks but could a machine do the same? So, for the sake of science (and good humor), I decided to put AI to the test and see if it could make me laugh.</p>
<p>I asked our class LLM to generate jokes for me, and then I rates them on a scale of 1-10 for how funny they are</p>
</section>
<section id="classic-jokes" class="level1">
<h1>CLASSIC JOKES</h1>
<p>I decided to start with a few classic joke styles: puns, one-liners, and dad jokes. AI seems to have a good grasp on these, but will they land the punchline? Here are some of the results:</p>
<p><img src="Post1_files/figure-html/2fba3cb3-7ac3-48d1-8e7a-4187e5652baf-4-fd24b90f-bc7f-471e-9960-0229a9feff09.png" class="img-fluid"></p>
<hr>
<section id="why-dont-skeletons-fight-each-other" class="level4">
<h4 class="anchored" data-anchor-id="why-dont-skeletons-fight-each-other">“Why don’t skeletons fight each other?</h4>
</section>
<section id="because-they-dont-have-the-guts." class="level4">
<h4 class="anchored" data-anchor-id="because-they-dont-have-the-guts.">Because they don’t have the guts.”</h4>
<p>Rating: 7/10 This one’s a classic. It hits the right balance of silly and clever. It’s a bit predictable, but I still laughed.</p>
<hr>
</section>
<section id="i-told-my-wife-she-was-drawing-her-eyebrows-too-high.-she-looked-surprised." class="level4">
<h4 class="anchored" data-anchor-id="i-told-my-wife-she-was-drawing-her-eyebrows-too-high.-she-looked-surprised.">“I told my wife she was drawing her eyebrows too high. She looked surprised.”</h4>
<p>Rating: 6/10 A little underwhelming. I see what AI was going for, but it didn’t quite have the punch I was hoping for. It’s a bit of a meh dad joke.</p>
<hr>
</section>
<section id="whats-orange-and-sounds-like-a-parrot" class="level4">
<h4 class="anchored" data-anchor-id="whats-orange-and-sounds-like-a-parrot">“What’s orange and sounds like a parrot?</h4>
</section>
<section id="a-carrot." class="level4">
<h4 class="anchored" data-anchor-id="a-carrot.">A carrot.”</h4>
<p>Rating: 3/10 I get that AI loves a good pun, but this one is just so bad. It really doesn’t work, AI, you tried, but this one’s a miss.</p>
<hr>
</section>
</section>
<section id="observational-one-liners" class="level1">
<h1>OBSERVATIONAL ONE LINERS</h1>
<p>Next, I thought I’d ask AI to come up with some observational humor, the kind that comments on everyday life or the weird stuff we as humans all know but never really talk about. I was curious to see if AI could pick up on little human relatable quirks like that.</p>
<p><img src="Post1_files/figure-html/2fba3cb3-7ac3-48d1-8e7a-4187e5652baf-3-f2dc9c98-d721-4d9b-bdd6-04646f73ee8e.png" class="img-fluid"></p>
<hr>
<section id="isnt-it-funny-how-we-can-talk-to-siri-for-hours-but-when-someone-asks-us-to-call-someone-we-freeze-like-weve-never-made-a-phone-call-in-our-life" class="level4">
<h4 class="anchored" data-anchor-id="isnt-it-funny-how-we-can-talk-to-siri-for-hours-but-when-someone-asks-us-to-call-someone-we-freeze-like-weve-never-made-a-phone-call-in-our-life">“Isn’t it funny how we can talk to Siri for hours, but when someone asks us to call someone, we freeze like we’ve never made a phone call in our life?”</h4>
<p>Rating: 6/10 Not bad, AI. It’s relatable, and I can definitely picture myself in that awkward moment where I forget how to dial a number. It’s not groundbreaking at all, or even really funny, but its relatable and I giggled.</p>
<hr>
</section>
<section id="why-is-it-that-every-time-we-want-to-be-productive-we-end-up-on-tiktok-watching-puppy-videos-is-it-the-puppy-videos-or-are-we-just-procrastinating-in-the-most-adorable-way-possible" class="level4">
<h4 class="anchored" data-anchor-id="why-is-it-that-every-time-we-want-to-be-productive-we-end-up-on-tiktok-watching-puppy-videos-is-it-the-puppy-videos-or-are-we-just-procrastinating-in-the-most-adorable-way-possible">“Why is it that every time we want to be productive, we end up on Tiktok watching puppy videos? Is it the puppy videos, or are we just procrastinating in the most adorable way possible?”</h4>
<p>Rating: 8/10 This one hit home as it is soooo true for me. I think we can all relate to wasting time watching cute animals when we should be working. Pretty good for an AI.</p>
<hr>
</section>
<section id="why-do-we-always-pretend-to-be-busy-when-were-actually-just-staring-at-the-wall" class="level4">
<h4 class="anchored" data-anchor-id="why-do-we-always-pretend-to-be-busy-when-were-actually-just-staring-at-the-wall">“Why do we always pretend to be busy when we’re actually just staring at the wall?”</h4>
<p>Rating: 4/10 Not funny at all, but I see the idea. It’s a good observation and an alarmingly human thing for an AI to know we often do, but the delivery could’ve been stronger.</p>
<hr>
</section>
</section>
<section id="dark-humor" class="level1">
<h1>DARK HUMOR</h1>
<p>I thought I’d push AI a little further and ask it for some darker humor. I wasn’t sure how it would handle this, but the results were interesting.</p>
<p><img src="Post1_files/figure-html/2fba3cb3-7ac3-48d1-8e7a-4187e5652baf-2-61b1d120-831b-4e97-8b2a-6076427fd20d.png" class="img-fluid"></p>
<hr>
<section id="i-told-my-therapist-i-had-a-fear-of-commitment.-she-said-lets-schedule-a-session-for-next-week-and-well-work-on-that." class="level4">
<h4 class="anchored" data-anchor-id="i-told-my-therapist-i-had-a-fear-of-commitment.-she-said-lets-schedule-a-session-for-next-week-and-well-work-on-that.">“I told my therapist I had a fear of commitment. She said, ‘Let’s schedule a session for next week, and we’ll work on that.’”</h4>
<p>Rating: 6/10 This one’s self-aware. It has the dark humor vibe, but I think it could use a little more edge to land better. Still, it’s got potential and is honestly better than I would expect.</p>
<hr>
</section>
<section id="i-once-tried-to-run-a-marathon-but-my-body-had-other-plans.-specifically-they-were-were-not-doing-this." class="level4">
<h4 class="anchored" data-anchor-id="i-once-tried-to-run-a-marathon-but-my-body-had-other-plans.-specifically-they-were-were-not-doing-this.">“I once tried to run a marathon, but my body had other plans. Specifically, they were: ‘We’re not doing this.’”</h4>
<p>Rating: 8/10 This one’s clever! It taps into a relatable struggle—trying and failing to do something ambitious and the delivery is good. Not sure it’s super dark but I liked it</p>
<hr>
</section>
<section id="whats-the-difference-between-a-hipster-and-a-graveyard" class="level4">
<h4 class="anchored" data-anchor-id="whats-the-difference-between-a-hipster-and-a-graveyard">“What’s the difference between a hipster and a graveyard?</h4>
</section>
<section id="the-graveyard-has-more-life." class="level4">
<h4 class="anchored" data-anchor-id="the-graveyard-has-more-life.">The graveyard has more life.”</h4>
<p>Rating: 3/10 This one is just weird.</p>
<hr>
<p>After putting AI through its comedic paces, I’d say it can definitely be funny—sometimes. But there’s a noticeable difference between the humor of AI and the humor we get from human comedians. While both share a basic formula—set-up, punchline, timing—the way AI and human comedians approach comedy is where things diverge.</p>
</section>
<section id="what-makes-human-comedy-jokes-different-from-ai-jokes" class="level2">
<h2 class="anchored" data-anchor-id="what-makes-human-comedy-jokes-different-from-ai-jokes">What makes human comedy jokes different from AI jokes?</h2>
<p>When it comes to human comedians, humor often comes with layers of personal experience, delivery, and a unique perspective on the world. Comedians like Dave Chappelle, Ali Wong, or John Mulaney have this uncanny ability to take everyday experiences and turn them into these deeply relatable, often profound, and always funny bits. Their timing is razor-sharp; they know how to pause, when to lean into a punchline, and how to give us just enough context to make the joke hit harder. It’s not just about the words—they build tension, create expectations, and then surprise us.</p>
<p>For example, a classic Mulaney bit about being a kid is funny because of how he’s able to give such a detailed picture of a child’s brain, then tie that to a hilarious (yet completely believable) observation about growing up. The relatability, the self-deprecation, the storytelling—it all works together. The punchline isn’t just the final line; it’s the entire setup that takes us to an unexpected conclusion.</p>
<p>AI’s humor, on the other hand, lacks that lived experience and human understanding of the world. Its jokes are more mechanical. It pulls from patterns in language and existing jokes, often replicating humor we’ve already heard—puns, dad jokes, and one-liners. There’s a clear pattern to AI’s jokes: it thrives on wordplay and simple observations. Take the skeleton joke from earlier: “Why don’t skeletons fight each other? Because they don’t have the guts.” The humor here is straightforward, but it’s almost too easy, too formulaic. The joke itself doesn’t come from a personal perspective or a twist on society—it’s based on a pun, which is an obvious play on words. It’s clever, but it doesn’t have the kind of depth or subtext that we get from human comics who inject their own experiences into their material.</p>
<p>AI doesn’t seem to understand why certain jokes are funnier based on the context in which they’re told. A human comedian will know exactly how to build a joke based on the energy of the crowd, the way the night’s going, or even their own mood. AI just spits out a punchline because that’s what it’s been trained to do. It doesn’t feel the rhythm or energy of humor—it just mimics.</p>
</section>
<section id="what-makes-ai-jokes-similar-to-human-jokes" class="level2">
<h2 class="anchored" data-anchor-id="what-makes-ai-jokes-similar-to-human-jokes">What makes AI jokes similar to human jokes?</h2>
<p><img src="Post1_files/figure-html/2fba3cb3-7ac3-48d1-8e7a-4187e5652baf-1-0a26be00-fc30-4818-b2af-4f68caeb3358.png" class="img-fluid"></p>
<p>(The first ever AI powered stand up show)</p>
<p>Despite the differences, there’s still something strikingly similar between AI-generated jokes and those from comedians. Both rely on patterns that people find universally funny: puns, exaggeration, and absurdity. A lot of humor is rooted in the unexpected, and AI can certainly tap into this, albeit in a more structured way. For example, the AI-generated joke about procrastination and cat videos hit the mark because it’s a universal observation: people get distracted by cute animals instead of doing important things. It works because it’s true. And while a comedian might add their own flair to it, AI is still able to capture the essence of what makes it relatable.</p>
<p>In a way, AI’s jokes are similar to those found in early stand-up routines where the jokes are more about general observations rather than personal stories. It’s a kind of humor that exists without the depth of a specific experience, but that doesn’t mean it’s not funny. AI can capture the structure of humor pretty well, even if it doesn’t always understand the nuance.</p>
</section>
<section id="where-does-ai-even-get-its-sense-of-humor" class="level2">
<h2 class="anchored" data-anchor-id="where-does-ai-even-get-its-sense-of-humor">Where does AI even get its “sense” of humor?</h2>
<p>This leads me to wonder: where does AI’s humor actually come from? Is it just a bunch of algorithms trained on massive datasets of jokes? Essentially, yes. AI learns humor by analyzing a huge pool of text—books, articles, websites, social media posts, and of course, jokes. It doesn’t truly “understand” what makes something funny in the way humans do. It’s more like AI is a super advanced “mimic” that’s incredibly good at picking up patterns and regurgitating them. The base of what is considered funny comes from human-created content, but AI doesn’t have the cultural context to make truly original humor.</p>
<p>AI’s jokes are built on probability. It can take certain elements—word associations, cultural references, and the structure of well-established jokes—and piece them together. It doesn’t know how to innovate in the way a comedian can; it just knows what worked in the past. But as funny as that is, it’s also a limitation. Humor is often about breaking expectations or delivering a punchline with the right timing or cultural context. AI doesn’t yet have the ability to understand the subtleties of social or emotional context in the same way humans do.</p>
</section>
<section id="what-surprised-me-about-ais-humor-what-was-ai-better-at-than-i-expected" class="level2">
<h2 class="anchored" data-anchor-id="what-surprised-me-about-ais-humor-what-was-ai-better-at-than-i-expected">What surprised me about AI’s humor? What was AI better at than I expected?</h2>
<p>What really surprised me about AI, though, is how well it did at observational humor. The joke about procrastination and cat videos? I didn’t expect AI to pull that off. It actually captured a very human experience—something that feels universal. The fact that AI picked up on this everyday observation and turned it into a solid joke made me realize that while it’s not perfect, it’s learning how to read situations and trends in a way that mirrors what makes humans laugh.</p>
<p>It also surprised me how quickly AI can generate jokes. While not every punchline lands perfectly, it’s able to process information and structure humor in real-time, something that would take a human comedian far more time to write, test, and refine. AI is a quick thinker, even if it lacks the depth to really make a joke feel alive.</p>
<hr>
<section id="can-ai-be-funny-yes-but-in-a-different-way-than-a-human-comedian." class="level4">
<h4 class="anchored" data-anchor-id="can-ai-be-funny-yes-but-in-a-different-way-than-a-human-comedian.">Can AI be funny? Yes, but in a different way than a human comedian.</h4>
<p>It can replicate basic humor patterns and structure jokes, but it doesn’t yet have the personal touch or nuanced understanding of why something is funny in a given context. The humor is still very much surface-level, but that doesn’t mean it can’t make you smile. It’s a fun experiment, but for now, human comedians still have the edge when it comes to creativity, timing, and injecting the rich context that makes humor truly memorable.</p>
<p>Would I trust AI to headline my comedy night? Probably not. But was it funnier than I expected? Yea it surprised me.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/noraelli\.github\.io\/comm4190_S25_Using_LLMs_Blog\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>